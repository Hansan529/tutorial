# NextJS

NextJS는 React의 프레임워크이다.

규칙이 이미 정해져 있어서 해당 규칙에 맞는 사용처에 사용만 하면 된다.

- CSR
  React는 HTML 파일이 비어있는데, Javascript로 해당 HTML을 채우는 것으로  
  처음 렌더링이 되지 않는 경우 빈 화면을 보다가, 렌더링이 완료되면 원하는 화면을 볼 수 있다.
  <br><br>
  초기 로드만 완료하면 이후에는 렌더링이 빠르다. (UX 상승)  
  서버에 요청하는 요소가 data를 얻을 때만 하기 때문에 부담이 적다.  
  웹 어플리케이션에 좋다.
  <br><br>
  물론 HTML이 비어있기에 SEO 검색 알고리즘에는 좋지 못하다.  
  파일이 클 경우 로드가 오래걸린다.

- SSR
  서버에서 리액트를 실행하고, 렌더링을하고 HTML에 전달해 앱의 초기 화면을 받는다.  
  그 다음에 Javascript를 받아 실행시킨다.
  <br>
  HTML에 모든 정보가 담겨있어 SEO 검색 알고리즘에 좋다.  
  HTML이 작성되어 있기 때문에 초기 로딩이 빠르다.  
  Static 사이트에 좋다.
  <br><br>
  서버에서 이미 렌더링하기 때문에 로딩이 오래걸리면 빈 화면을 볼 수 있음.  
  변경이 있는 경우 매 번 새롭게 로딩하기 때문에 서버 부하가 큼  
  페이지를 요청할 때 마다 새로고침이 된다. (UX 감소)

React는 CSR인데, SEO에 취약하기 때문에 기초 렌더를 한 SSR 을 사용해 NextJS로  
React가 필요하지 않는 기본 HTML을 채우고, 렌더가 완료되면 그 후부터 React로 CSR 방식으로 유연하게 사용하도록 하는게  
NextJS이다.

**CSR의 장점을 사용하기 위해 SSR 형식을 사용해 단점을 보완해주는 프레임워크이다.**

---

## NextJS 라우팅

Next.js 13 에는 page 폴더에서 app 폴더로 변경이 되었다.

그래서 다음과 같이 사용해주어야 한다.

```
src / app
  layout.tsx
  page.tsx
  dashboard /
    layout.tsx
    page.tsx
```

`app` 폴더에 page.tsx (typescript) 파일이 `/` RootRouter가 되었다.  
`dashboard`의 `page.tsx`는 `/dashboard/` 의 기본 렌더 파일이 된다.

nesting 방식으로 Router 처리가 된다.

`/dashboard/settings` 에 접근하려면 폴더 루트를 다음과 같이 하면 된다.

```
src / app
  ...
  dashboard /
    layout.tsx
    page.tsx
    settings /
      page.tsx
```

각 루트별로 layout을 설정하고, 그 안에서 세부 사이드 page를 지정해준다.

- **page.tsx**: UI를 정의하는데 사용되는 파일 (HTML 코드가 작성될 파일)
- **layout.tsx**: 여러 페이지에서 공유되는 UI를 정의하는데 사용함, 다른 레이아웃이나 페이지를 children으로 받아들인다.
  layout을 중첩(nesting) 하여 경로를 만들 수 있음.
- **loading.tsx**: 로딩 UI를 만드는데 사용하는 파일 (선택적)
- **error.tsx**: 오류를 앱의 특정 부분으로 분리하고 오류 복구를 시도하는 기능을 표시하는데 사용함 (선택적)
- **template.tsx**: 레이아웃과 유사하지만 구성 요소의 새 인스턴스가 마운트되고 상태가 공유되지 않는 선택적 파일, 들어오고 나가기 애니매이션과 같은 동작에 사용 할 수 있음
- **head.tsx**: 주어진 경로에 대한 <head> 태그의 콘텐츠를 정의하는데 사용함 (선택적)

### Layout (Layout은 `children`이 필요하다)

루트 레이아웃(필수)과 중첩 레이아웃으로 사용한다.

```tsx
// app/layout.tsx
import "./globals.css";
import { Inter } from "next/font/google";

const inter = Inter({ subsets: ["latin"] });

export const metadata = {
  title: "NextJS로 만든 페이지",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body className={inter.className}>{children}</body>
    </html>
  );
}
```

```tsx
export default function DashboardLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return {
    <section>{children}</section>
  };
}
```

`app/layout`에 설정한 layout이 `/dashboard` 에서도 중첩되어 적용된다.

```html
<html lang="en">
  <body class="...">
    <section>
      <!-- return page.tsx -->
    </section>
  </body>
</html>
```

_이전 버전에는 pages/ 에 파일 명이 Router였다._

```
pages/
  index.tsx
  dashboard.tsx
```

`/dashboard` 가 경로가 된다.
